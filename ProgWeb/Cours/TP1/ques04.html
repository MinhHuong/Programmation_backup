<html>
<head>
	<meta charset="utf-8">
	<title></title>
	<script id="music" type="application/json">
	[
		{ "Nom_Musicien": "Bacelli","Prenom_Musicien": "Monica" },
		{ "Nom_Musicien": "Bach", "Prenom_Musicien": "Carl-Philip-Emmanuel" },
		{ "Nom_Musicien": "Bayrakdarian", "Prenom_Musicien":"Isabel" }
	] 
	</script>
	<script type="text/javaScript">
	//Classe Personne
	function Personne(n, p) {
		this.nom = n;
		this.prenom = p;
	}

	Personne.afficheIdentite = function () {
		return this.nom + " " + this.prenom;
	}

	//Classe Musicien
	function Musicien(n, p, i) {
		Musicien.prototype = Personne;
		Personne.apply(this, arguments);
		//this.instrument = "piano";
		this.instrument = i;
		this.afficheIdentite = function () {
			return Personne.afficheIdentite.call(this) + ", " + this.instrument;
		}
	}

	//Classe Adresse
	function Adresse(v, r) {
		this.ville = v;
		this.rue = r;
		this.adresse = function () {
			return this.rue + " " + this.ville;
		}
	}

	//Classe Abonné
	function Abonne(n, p, r, v, c ) {
		Abonne.prototype = Personne;
		Personne.apply(this, arguments);
		this.code = c;
		this.adresse = new Adresse(v, r);
		this.afficheIdentite = function () {
			return this.code + " " + Personne.afficheIdentite.call(this) + " " +
			this.adresse.adresse();
		}
	}

	// Tableaux de données
	var artistes = [];
	var personnes = [];
	var abonnes = [];

	// Affichage des éléments du tableau
	Array.prototype.Affiche = function (liste) {
		var list = document.getElementById(liste);
		list.style.visibility = "visible";
		while (list.lastChild)
			list.removeChild(list.lastChild);
		this.forEach(function (elem) {
			var li = document.createElement("li");
			li.appendChild(document.createTextNode(elem.afficheIdentite()));
			list.appendChild(li);
		});
	};

	 // Chargement des données
	function ChargeMusiciens() {
	 	var musiciens = JSON.parse(document.getElementById('music').text);
	 	musiciens.forEach(function(e) {
	 		var mus = new Musicien(e.Nom_Musicien, e.Prenom_Musicien, 'Piano');
	 		artistes.push( mus);
	 		personnes.push(mus);
	 	});
	}

	function InsereAbonne() {
	 	var nom = document.getElementById("nom").value;
	 	var prenom = document.getElementById("prenom").value;
	 	var rue = document.getElementById("rue").value;
	 	var ville = document.getElementById("ville").value;
	 	var code = parseInt(document.getElementById("code").value);
	 	document.getElementById("code").value = code + 1;
	 	var ab = new Abonne(nom, prenom, rue, ville, code);
	 	abonnes.push(ab);
	 	personnes.push(ab);
	 	abonnes.Affiche('Abonnes');
	}

	function AfficheMusiciens() {
		artistes.Affiche('Musiciens');
	}

	function AffichePersonnes() {
		personnes.Affiche('Personnes');
	}
	</script>
</head>

<body onload="ChargeMusiciens();">
	<button onclick="AfficheMusiciens();">Afficher la liste des musiciens</button>
	<h2>Liste des musiciens</h2>
	<div>
		<ul id='Musiciens'></ul>
	</div>

	<br>
	<form>
		<span>Nom</span><input id="nom" type="text"><br>
		<span>Prenom</span><input id="prenom" type="text"><br>
		<span>Rue</span><input id="rue" type="text"><br>
		<span>Ville</span><input id="ville" type="text"><br>
		<input id="code" type="hidden" value="1"><br>
	</form>

	<br>
	<button onclick="InsereAbonne();">Ajouter un abonne</button>
	<h2>Liste des abonnes</h2>
	<div>
		<ul id='Abonnes'></ul>
	</div>

	<br>
	<button onclick="AffichePersonnes();">Afficher la liste de toutes les personnes</button>
	<h2>Liste des personnes</h2>
	<div>
		<ul id='Personnes'></ul>
	</div>
</body>

</html>